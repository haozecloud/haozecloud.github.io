<!DOCTYPE html>
<html lang='zh-CN'>

<head>
  <meta name="generator" content="Hexo 6.3.0">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.19.0">
  <meta charset="utf-8">
  

  <meta http-equiv='x-dns-prefetch-control' content='on' />
  <link rel='dns-prefetch' href='https://gcore.jsdelivr.net'>
  <link rel="preconnect" href="https://gcore.jsdelivr.net" crossorigin>
  <link rel='dns-prefetch' href='//unpkg.com'>

  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#f8f8f8">
  
  <title>Samba文件服务器 - 原点独白</title>

  
    <meta name="description" content="一、samba介绍在早期的网络世界当中，不同主机的文件传输大多使用FTP来进行。不过FTP却有个小小的问题， 那就是你无法直接修改主机上面的文件内容！也就是说，你想要更改Linux主机上面的某个文件时，你必须要将该文件下载后才能修改。在日常办公环境中，操作系统除了windows以外，还有linux或者UNIX。windows和linux或UNIX之间共享文件是无法直接完成的，为了解析不同系统之间的">
<meta property="og:type" content="article">
<meta property="og:title" content="Samba文件服务器">
<meta property="og:url" content="https://haozecloud.github.io/2023/09/27/%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%B9%8B%E4%BC%81%E4%B8%9A%E5%AD%98%E5%82%A8/Samba%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/index.html">
<meta property="og:site_name" content="原点独白">
<meta property="og:description" content="一、samba介绍在早期的网络世界当中，不同主机的文件传输大多使用FTP来进行。不过FTP却有个小小的问题， 那就是你无法直接修改主机上面的文件内容！也就是说，你想要更改Linux主机上面的某个文件时，你必须要将该文件下载后才能修改。在日常办公环境中，操作系统除了windows以外，还有linux或者UNIX。windows和linux或UNIX之间共享文件是无法直接完成的，为了解析不同系统之间的">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932158638.png">
<meta property="og:image" content="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932179228.png">
<meta property="og:image" content="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932192673.png">
<meta property="og:image" content="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932207260.png">
<meta property="og:image" content="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932305163.png)">
<meta property="og:image" content="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932645309.png">
<meta property="og:image" content="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932658185.png">
<meta property="og:image" content="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932672237.png">
<meta property="og:image" content="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932687479.png">
<meta property="og:image" content="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932698858.png">
<meta property="article:published_time" content="2023-09-27T00:01:42.000Z">
<meta property="article:modified_time" content="2023-09-27T12:01:43.471Z">
<meta property="article:author" content="Zhang Hao Ze">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932158638.png">
  
  
  
  

  <!-- feed -->
  

  
    
<link rel="stylesheet" href="/css/main.css">

  

  
    <link rel="shortcut icon" href="https://img1.imgtp.com/2023/09/25/3pQ59aAI.png">
  

  

  


  
</head>

<body>
  




  <div class='l_body' id='start'>
    <aside class='l_left' layout='post'>
    

  

<header class="header"><div class="logo-wrap"><a class="avatar" href="/about/"><div class="bg" style="opacity:0;background-image:url(https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/avatar/round/rainbow64@3x.webp);"></div><img no-lazy class="avatar" src="https://img1.imgtp.com/2023/09/25/3pQ59aAI.png" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/image/2659360.svg';"></a><a class="title" href="/"><div class="main" ff="title">原点独白</div><div class="sub cap">微信公众号</div></a></div>

<nav class="menu dis-select"><a class="nav-item active" href="/">文章</a><a class="nav-item" href="/wiki/">项目</a><a class="nav-item" href="/images/">照片</a><a class="nav-item" href="/more/">日常</a></nav>
</header>


<div class="widgets">

<widget class="widget-wrapper toc single" id="data-toc"><div class="widget-header cap dis-select"><span class="name">Samba文件服务器</span></div><div class="widget-body fs14"><div class="doc-tree active"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81samba%E4%BB%8B%E7%BB%8D"><span class="toc-text">一、samba介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">应用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SAMBA%E4%B8%8ENetBIOS"><span class="toc-text">SAMBA与NetBIOS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SAMBA%E7%9A%84%E7%9B%B8%E5%85%B3%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B"><span class="toc-text">SAMBA的相关守护进程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SAMBA%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-text">SAMBA的工作流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="toc-text">相关软件包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%96%87%E4%BB%B6"><span class="toc-text">相关文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81samba%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2"><span class="toc-text">二、samba安装部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81samba%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3"><span class="toc-text">三、samba配置文件详解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81samba%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB%E6%A1%88%E4%BE%8B"><span class="toc-text">四、samba文件共享案例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%85%B1%E4%BA%AB%E6%A1%88%E4%BE%8B-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%AE%BF%E9%97%AE%E5%85%B1%E4%BA%AB"><span class="toc-text">五、共享案例-客户端访问共享</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E7%94%A8%E6%88%B7%E8%B4%A6%E5%8F%B7%E6%98%A0%E5%B0%84%E4%B8%8E%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-text">六、用户账号映射与访问控制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81SAMBA%E7%9A%84%E6%8E%92%E9%94%99"><span class="toc-text">七、SAMBA的排错</span></a></li></ol></div></div></widget>



<widget class="widget-wrapper search"><div class="widget-body"><div class="search-wrapper" id="search"><form class="search-form"><input type="text" class="search-input" id="search-input" placeholder="站内搜索"><svg t="1670596976048" class="icon search-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2676" width="200" height="200"><path d="M938.2 832.6L723.8 618.1c-2.5-2.5-5.3-4.4-7.9-6.4 36.2-55.6 57.3-121.8 57.3-193.1C773.3 222.8 614.6 64 418.7 64S64 222.8 64 418.6c0 195.9 158.8 354.6 354.6 354.6 71.3 0 137.5-21.2 193.2-57.4 2 2.7 3.9 5.4 6.3 7.8L832.5 938c14.6 14.6 33.7 21.9 52.8 21.9 19.1 0 38.2-7.3 52.8-21.8 29.2-29.1 29.2-76.4 0.1-105.5M418.7 661.3C284.9 661.3 176 552.4 176 418.6 176 284.9 284.9 176 418.7 176c133.8 0 242.6 108.9 242.6 242.7 0 133.7-108.9 242.6-242.6 242.6" p-id="2677"></path></svg></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div></div></widget>


</div>
<footer class="footer dis-select"><div class="social-wrap"><a class="social" href="https://pd.qq.com/s/77potx4h8" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cloud-1317067033.cos.ap-chengdu.myqcloud.com/images/QQ-2023-09-29.svg"/></a><a class="social" href="https://i.y.qq.com/n2/m/share/details/taoge.html?platform=11&appshare=android_qq&appversion=12070008&hosteuin=oinFoK4soe-lNn**&id=3144152480&ADTAG=wxfshare" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cloud-1317067033.cos.ap-chengdu.myqcloud.com/images/qq音乐-2023-09-29.svg"/></a><a class="social" href="https://www.cnblogs.com/mant" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cloud-1317067033.cos.ap-chengdu.myqcloud.com/images/linux-2023-09-29.svg"/></a><a class="social" href="https://alidocs.dingtalk.com/i/p/O5pXBPdVlgnMQG7Z" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cloud-1317067033.cos.ap-chengdu.myqcloud.com/images/钉钉-2023-09-29.svg"/></a></div></footer>

    </aside>
    <div class='l_main'>
      

      



<div class="bread-nav fs12"><div id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a><span class="sep"></span><a class="cap breadcrumb" href="/">文章</a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/Linux/">Linux</a> <span class="sep"></span> <a class="cap breadcrumb-link" href="/categories/Linux/%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%B9%8B%E4%BC%81%E4%B8%9A%E5%AD%98%E5%82%A8/">数据安全之企业存储</a></div><div id="post-meta">发布于&nbsp;<time datetime="2023-09-27T00:01:42.000Z">2023-09-27</time></div></div>

<article class='md-text content post'>
<h1 class="article-title"><span>Samba文件服务器</span></h1>
<h2 id="一、samba介绍"><a href="#一、samba介绍" class="headerlink" title="一、samba介绍"></a>一、samba介绍</h2><p>在早期的网络世界当中，不同主机的文件传输大多使用FTP来进行。不过FTP却有个小小的问题， 那就是你无法直接修改主机上面的文件内容！也就是说，你想要更改Linux主机上面的某个文件时，你必须要将该文件下载后才能修改。在日常办公环境中，操作系统除了windows以外，还有linux或者UNIX。windows和linux或UNIX之间共享文件是无法直接完成的，为了解析不同系统之间的文件和打印机等资源的共享，我们今天来介绍一下samba服务。他可以解决不同系统平台之间的共享问题。</p>
<p>Samba是在Linux和UNIX系统上实现SMB协议的一个免费软件，由服务器及客户端程序构成，也是一个C&#x2F;S软件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SMB（Server Messages Block，信息服务块）是一种在局域网上共享文件和打印机的一种通信协议，它为局域网内的不同计算机之间提供文件及打印机等资源的共享服务。SMB协议是客户机/服务器型协议，客户机通过该协议可以访问服务器上的共享文件系统、打印机及其他</span><br></pre></td></tr></table></figure>

<h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><p><strong>文件与打印机共享：</strong> samba的主要功能，samba进程实现资源共享，将文件和打印机甚至是设备（如：CDROM）发布到网络中，以供用户访问</p>
<p><strong>身份验证和权限验证：</strong> 对用户身份进行验证及权限设置，通过加密的方式保护共享文件和打印机</p>
<p><strong>名称解析：</strong> 通过nmbd服务实现名称解析，将NetBIOS名称解析为IP地址</p>
<p><strong>浏览服务：</strong> 在局域中，samba可以成为本地主浏览器，保存可用</p>
<p>资源列表，当用户访问时，会提供浏览列表</p>
<h3 id="SAMBA与NetBIOS"><a href="#SAMBA与NetBIOS" class="headerlink" title="SAMBA与NetBIOS"></a>SAMBA与NetBIOS</h3><p>samba是构建在NetBIOS这个协议之上的，而NetBIOS最早是从IBM诞生的，目的是让局域网内的计算机能够进行网络连接，由于不是针对于大型网络，所以NetBIOS是无法跨路由的。而windows操作系统也支持这个协议，所以在Linux主机上使用SAMBA部署的共享服务是可以使用windows主机访问的。那么SAMBA是不是就不能跨路由提供服务了呢？并不是，我们可以通过一个叫NetBIOS over TCP&#x2F;IP的技术实现跨路由的SAMBA服务，但是目前SAMBA还是在局域网用的较多</p>
<h3 id="SAMBA的相关守护进程"><a href="#SAMBA的相关守护进程" class="headerlink" title="SAMBA的相关守护进程"></a>SAMBA的相关守护进程</h3><p><strong>nmbd</strong>：使用UDP的137、138来提供名称解析服务（NetBIOS）</p>
<p><strong>smbd</strong>：管理共享和数据传输，使用的端为TCP的139、445</p>
<h3 id="SAMBA的工作流程"><a href="#SAMBA的工作流程" class="headerlink" title="SAMBA的工作流程"></a>SAMBA的工作流程</h3><p>1、协议协商</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932158638.png" alt="image20200306095957499.png"/></div><div class="image-meta"><span class="image-caption center">image20200306095957499.png</span></div></div>

<p>客户端在访问服务器时，发送negprot请求，告知服务器自己所支持的SMB类型，samba服务器根据客户端的情况，选择最优的SMB类型并作出回应</p>
<p>2、建立连接</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932179228.png" alt="image20200306100342210.png"/></div><div class="image-meta"><span class="image-caption center">image20200306100342210.png</span></div></div>
<p>当SMB类型确认后，客户端会发送session setup指令数据包，提交账号和密码，请求与samba服务器建立连接，如果客户端通过身份验证，服务器会作出回应，并为用户分配一个唯一的UID，在客户端与服务器通信时使用。</p>
<p>3、访问共享资源</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932192673.png" alt="image20200306101103005.png"/></div><div class="image-meta"><span class="image-caption center">image20200306101103005.png</span></div></div>

<p>当客户端需要访问共享资源时，会发送tree connect数据包，告知服务器需要访问的共享资源的名称，如果设置允许，samba服务器会为每个客户端与共享资源连接分配一个TID(线程标识符)，客户端就可以访问相应的共享资源</p>
<p>4、断开连接</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932207260.png" alt="image20200306101521438.png"/></div><div class="image-meta"><span class="image-caption center">image20200306101521438.png</span></div></div>

<p>共享使用完毕，客户端向服务器发送tree disconnect报文关闭对共享的访问，与服务器断开连接</p>
<h3 id="相关软件包"><a href="#相关软件包" class="headerlink" title="相关软件包"></a>相关软件包</h3><p>samba 主程序包，服务端需要</p>
<p>samba-client 客户端工具包</p>
<p>samba-common 通用工具和库文件，客户端服务器端都需要安装</p>
<h3 id="相关文件"><a href="#相关文件" class="headerlink" title="相关文件"></a>相关文件</h3><ul>
<li>&#x2F;etc&#x2F;samba&#x2F;smb.conf 主配置文件</li>
<li>&#x2F;etc&#x2F;samba&#x2F;smb.conf.example 模板文件</li>
<li>&#x2F;var&#x2F;log&#x2F;samba&#x2F;log.nmbd nmbd进程的解析信息</li>
<li>&#x2F;var&#x2F;log&#x2F;samba&#x2F;log.smbd 记录用户的访问记录、服务器的问题</li>
</ul>
<h2 id="二、samba安装部署"><a href="#二、samba安装部署" class="headerlink" title="二、samba安装部署"></a>二、samba安装部署</h2><p>a、安装软件包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# dnf install samba samba-client  -y</span><br></pre></td></tr></table></figure>

<p>b、设置服务开机启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# systemctl enable nmb.service smb.service </span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/nmb.service → /usr/lib/systemd/system/nmb.service.</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/smb.service → /usr/lib/systemd/system/smb.service.</span><br></pre></td></tr></table></figure>

<p>c、开启服务</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# systemctl start nmb smb</span><br></pre></td></tr></table></figure>

<h2 id="三、samba配置文件详解"><a href="#三、samba配置文件详解" class="headerlink" title="三、samba配置文件详解"></a>三、samba配置文件详解</h2><p>主配文件路径: &#x2F;etc&#x2F;samba&#x2F;smb.conf</p>
<p>模板文件：&#x2F;etc&#x2F;samba&#x2F;smb.conf.example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br></pre></td><td class="code"><pre><span class="line">[root@baism ~]# cat smb.conf.example </span><br><span class="line"># This is the main Samba configuration file. For detailed information about the</span><br><span class="line"># options listed here, refer to the smb.conf(5) manual page. Samba has a huge</span><br><span class="line"># number of configurable options, most of which are not shown in this example.</span><br><span class="line">#</span><br><span class="line"># The Samba Wiki contains a lot of step-by-step guides installing, configuring,</span><br><span class="line"># and using Samba:</span><br><span class="line"># https://wiki.samba.org/index.php/User_Documentation</span><br><span class="line">#</span><br><span class="line"># In this file, lines starting with a semicolon (;) or a hash (#) are</span><br><span class="line"># comments and are ignored. This file uses hashes to denote commentary and</span><br><span class="line"># semicolons for parts of the file you may wish to configure.</span><br><span class="line">#</span><br><span class="line"># NOTE: Run the &quot;testparm&quot; command after modifying this file to check for basic</span><br><span class="line"># syntax errors.</span><br><span class="line">#</span><br><span class="line">#---------------</span><br><span class="line">#</span><br><span class="line">SAMBA selinux相关设置，如果你开启了selinux，请注意下面的说明</span><br><span class="line">#</span><br><span class="line">#</span><br><span class="line">#Security-Enhanced Linux (SELinux) Notes:</span><br><span class="line">#</span><br><span class="line"># Turn the samba_domain_controller Boolean on to allow a Samba PDC to use the</span><br><span class="line"># useradd and groupadd family of binaries. Run the following command as the</span><br><span class="line"># root user to turn this Boolean on:</span><br><span class="line">如果你在域环境中使用samba那么请设置下面的bool值</span><br><span class="line"># setsebool -P samba_domain_controller on</span><br><span class="line">#</span><br><span class="line"># Turn the samba_enable_home_dirs Boolean on if you want to share home</span><br><span class="line"># directories via Samba. Run the following command as the root user to turn this</span><br><span class="line"># Boolean on:</span><br><span class="line">#</span><br><span class="line">假如希望通过samba共享用户家目录请设置下面的bool值</span><br><span class="line"># setsebool -P samba_enable_home_dirs on</span><br><span class="line">#</span><br><span class="line"># If you create a new directory, such as a new top-level directory, label it</span><br><span class="line"># with samba_share_t so that SELinux allows Samba to read and write to it. Do</span><br><span class="line"># not label system directories, such as /etc/ and /home/, with samba_share_t, as</span><br><span class="line"># such directories should already have an SELinux label.</span><br><span class="line">#</span><br><span class="line">加入你想将目录通过samba共享，请确认其目录标签为sambe_share_t</span><br><span class="line"># Run the &quot;ls -ldZ /path/to/directory&quot; command to view the current SELinux</span><br><span class="line"># label for a given directory.</span><br><span class="line">#</span><br><span class="line"># Set SELinux labels only on files and directories you have created. Use the</span><br><span class="line"># chcon command to temporarily change a label:</span><br><span class="line">标签设置方法</span><br><span class="line"># chcon -t samba_share_t /path/to/directory</span><br><span class="line">#</span><br><span class="line"># Changes made via chcon are lost when the file system is relabeled or commands</span><br><span class="line"># such as restorecon are run.</span><br><span class="line">#</span><br><span class="line"># Use the samba_export_all_ro or samba_export_all_rw Boolean to share system</span><br><span class="line"># directories. To share such directories and only allow read-only permissions:</span><br><span class="line">对共享目录的权限的bool设置，只读或读写</span><br><span class="line"># setsebool -P samba_export_all_ro on</span><br><span class="line"># To share such directories and allow read and write permissions:</span><br><span class="line"># setsebool -P samba_export_all_rw on</span><br><span class="line">#</span><br><span class="line"># To run scripts (preexec/root prexec/print command/...), copy them to the</span><br><span class="line"># /var/lib/samba/scripts/ directory so that SELinux will allow smbd to run them.</span><br><span class="line"># Note that if you move the scripts to /var/lib/samba/scripts/, they retain</span><br><span class="line"># their existing SELinux labels, which may be labels that SELinux does not allow</span><br><span class="line"># smbd to run. Copying the scripts will result in the correct SELinux labels.</span><br><span class="line"># Run the &quot;restorecon -R -v /var/lib/samba/scripts&quot; command as the root user to</span><br><span class="line"># apply the correct SELinux labels to these files.</span><br><span class="line">#</span><br><span class="line">#--------------</span><br><span class="line">#</span><br><span class="line">#======================= Global Settings =====================================</span><br><span class="line">全局设置，对整个服务都生效</span><br><span class="line">[global]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">网络设置</span><br><span class="line"># ----------------------- Network-Related Options -------------------------</span><br><span class="line">#</span><br><span class="line"># workgroup = the Windows NT domain name or workgroup name, for example, MYGROUP.</span><br><span class="line">#</span><br><span class="line"># server string = the equivalent of the Windows NT Description field.</span><br><span class="line">#</span><br><span class="line"># netbios name = used to specify a server name that is not tied to the hostname,</span><br><span class="line">#                maximum is 15 characters.</span><br><span class="line">#</span><br><span class="line"># interfaces = used to configure Samba to listen on multiple network interfaces.</span><br><span class="line"># If you have multiple interfaces, you can use the &quot;interfaces =&quot; option to</span><br><span class="line"># configure which of those interfaces Samba listens on. Never omit the localhost</span><br><span class="line"># interface (lo).</span><br><span class="line">#</span><br><span class="line"># hosts allow = the hosts allowed to connect. This option can also be used on a</span><br><span class="line"># per-share basis.</span><br><span class="line">#</span><br><span class="line"># hosts deny = the hosts not allowed to connect. This option can also be used on</span><br><span class="line"># a per-share basis.</span><br><span class="line">#</span><br><span class="line">定义计算机的工作组,如果希望和windows共享，可以设置为workgroup，这样就可以在windows的网上邻居中找到linux计算机</span><br><span class="line">    workgroup = MYGROUP</span><br><span class="line">对samba服务器的描述信息</span><br><span class="line">    server string = Samba Server Version %v</span><br><span class="line">设置netbios计算机名称</span><br><span class="line">;    netbios name = MYSERVER</span><br><span class="line"></span><br><span class="line">samba使用本机的那块网卡</span><br><span class="line">;    interfaces = lo eth0 192.168.12.2/24 192.168.13.2/24</span><br><span class="line">允许那个网段访问samba服务器共享，还可以使用“hosts deny”设置禁止的网段，“hosts allow”的优先级高，表现形式可以是具体的IP地址和域名，还可以是*、？、local、all，也可以使用EXCEPT排除</span><br><span class="line">如：hosts allow = 192.168.0. EXCEPT 192.168.0.100</span><br><span class="line">;    hosts allow = 127. 192.168.12. 192.168.13.</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line">日志选项</span><br><span class="line"># --------------------------- Logging Options -----------------------------</span><br><span class="line">#</span><br><span class="line"># log file = specify where log files are written to and how they are split.</span><br><span class="line">#</span><br><span class="line"># max log size = specify the maximum size log files are allowed to reach. Log</span><br><span class="line"># files are rotated when they reach the size specified with &quot;max log size&quot;.</span><br><span class="line">#</span><br><span class="line">samba日志文件路径，%m表示客户端的NetBios名称，还有其它的变量，可以使用man smb.conf通过man手册去查看</span><br><span class="line">    # log files split per-machine:</span><br><span class="line">    log file = /var/log/samba/log.%m</span><br><span class="line">日志文件大小，0为不限制，注意不建议这样设置</span><br><span class="line">    # maximum size of 50KB per log file, then rotate:</span><br><span class="line">    max log size = 50</span><br><span class="line"></span><br><span class="line">独立服务选项</span><br><span class="line"># ----------------------- Standalone Server Options ------------------------</span><br><span class="line">#</span><br><span class="line"># security = the mode Samba runs in. This can be set to user, share</span><br><span class="line"># (deprecated), or server (deprecated).</span><br><span class="line">#</span><br><span class="line"># passdb backend = the backend used to store user information in. New</span><br><span class="line"># installations should use either tdbsam or ldapsam. No additional configuration</span><br><span class="line"># is required for tdbsam. The &quot;smbpasswd&quot; utility is available for backwards</span><br><span class="line"># compatibility.</span><br><span class="line">#</span><br><span class="line">samba安全级别</span><br><span class="line">share:  不需要账号密码，公开共享</span><br><span class="line">user:   需要提供samba账号密码才能访问共享，私密共享</span><br><span class="line">server：依靠其他Windows NT/2000或Samba Server来验证用户的账号和密码,是一种代理验证。此种安全模式下,系统管理员可以把所有的Windows用户和口令集中到一个NT系统上,&gt;使用Windows NT进行Samba认证, 远程服务器可以自动认证全部用户和口令,如果认证失败,Samba会使用user级别。</span><br><span class="line">domain：如果samba服务器加入到域环境中，验证工作由域控制器完成。</span><br><span class="line">ads：具备domain级别的所有功能，并且具备域控制器功能</span><br><span class="line">auto:安全级别会受“server role”字段的值影响，“server role”字段默认值为auto（用户通过验证后可以使用），其余的参数决定了samba服务器加入到window域环境中的角色是成员还是域控制器</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">一般情况下我们使用share和user的比较多，除非公司有完整的域环境</span><br><span class="line">    security = user</span><br><span class="line"></span><br><span class="line">用户及密码的管理方式，有三种smbpasswd、tdbsam、ldapsam</span><br><span class="line">smbpasswd:使用samba自带的工具smbpasswd命令为用户（真实用户或虚拟用户）设置密码，密码默认存放在/var/lib/samba/private/smbpasswd文件中，也可以使用“</span><br><span class="line">smb passwd file = /etc/samba/smbpasswd&quot;指定密码文件位置</span><br><span class="line">			smbpasswd	-a username	添加一个用户/修改用户密码</span><br><span class="line">			smbpasswd -d username	禁用用户</span><br><span class="line">			smbpasswd -e username	启用用户</span><br><span class="line">			smbpasswd -x username	删除用户</span><br><span class="line">tdbsam：在/var/lib/samba/private建立一个passdb.tdb存放密码，也可以使用“smb passwd file”字段指定存放位置，除了可以使用smbpasswd命令管理用户之外，还可以使用pdbedit命令指定，而且只能是系统用户（真实用户），用户的建立可以使用mksmbpasswd命令建立一个smbpasswd文件，再使用pdbedit将文件里的用户导入数据库</span><br><span class="line">cat /etc/passwd | mksmbpasswd &gt; /etc/samba/smbpasswd</span><br><span class="line">pdbedit -i smbpasswd:/etc/samba/smbpasswd</span><br><span class="line"></span><br><span class="line">额外的用法</span><br><span class="line">pdbedit -a username：新建Samba账户。</span><br><span class="line">pdbedit -x username：删除Samba账户。</span><br><span class="line">pdbedit -L：列出Samba用户列表，读取passdb.tdb数据库文件。</span><br><span class="line">pdbedit -Lv：列出Samba用户列表的详细信息。</span><br><span class="line">pdbedit -c “[D]” –u username：禁用该Samba用户的账号。</span><br><span class="line">pdbedit -c “[]” –u username：恢复该Samba用户的账号。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ldapsam：基于LDAP的认证方式，首先要有LDAP服务，并且加入到LDAP中</span><br><span class="line">			</span><br><span class="line">    passdb backend = tdbsam</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">域成员选项</span><br><span class="line"># ----------------------- Domain Members Options ------------------------</span><br><span class="line">#</span><br><span class="line"># security = must be set to domain or ads.</span><br><span class="line">#</span><br><span class="line"># passdb backend = the backend used to store user information in. New</span><br><span class="line"># installations should use either tdbsam or ldapsam. No additional configuration</span><br><span class="line"># is required for tdbsam. The &quot;smbpasswd&quot; utility is available for backwards</span><br><span class="line"># compatibility.</span><br><span class="line">#</span><br><span class="line"># realm = only use the realm option when the &quot;security = ads&quot; option is set.</span><br><span class="line"># The realm option specifies the Active Directory realm the host is a part of.</span><br><span class="line">#</span><br><span class="line"># password server = only use this option when the &quot;security = server&quot;</span><br><span class="line"># option is set, or if you cannot use DNS to locate a Domain Controller. The</span><br><span class="line"># argument list can include My_PDC_Name, [My_BDC_Name], and [My_Next_BDC_Name]:</span><br><span class="line">#</span><br><span class="line"># password server = My_PDC_Name [My_BDC_Name] [My_Next_BDC_Name]</span><br><span class="line">#</span><br><span class="line"># Use &quot;password server = *&quot; to automatically locate Domain Controllers.</span><br><span class="line">#设置域共享</span><br><span class="line">;    security = domain</span><br><span class="line">;    passdb backend = tdbsam</span><br><span class="line">#定义域名称</span><br><span class="line">;    realm = MY_REALM</span><br><span class="line">#域验证服务器</span><br><span class="line">;    password server = &lt;NT-Server-Name&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#域控选项</span><br><span class="line"># ----------------------- Domain Controller Options ------------------------</span><br><span class="line">#</span><br><span class="line"># security = must be set to user for domain controllers.</span><br><span class="line">#</span><br><span class="line"># passdb backend = the backend used to store user information in. New</span><br><span class="line"># installations should use either tdbsam or ldapsam. No additional configuration</span><br><span class="line"># is required for tdbsam. The &quot;smbpasswd&quot; utility is available for backwards</span><br><span class="line"># compatibility.</span><br><span class="line">#</span><br><span class="line"># domain master = specifies Samba to be the Domain Master Browser, allowing</span><br><span class="line"># Samba to collate browse lists between subnets. Do not use the &quot;domain master&quot;</span><br><span class="line"># option if you already have a Windows NT domain controller performing this task.</span><br><span class="line">#</span><br><span class="line"># domain logons = allows Samba to provide a network logon service for Windows</span><br><span class="line"># workstations.</span><br><span class="line">#</span><br><span class="line"># logon script = specifies a script to run at login time on the client. These</span><br><span class="line"># scripts must be provided in a share named NETLOGON.</span><br><span class="line">#</span><br><span class="line"># logon path = specifies (with a UNC path) where user profiles are stored.</span><br><span class="line">#</span><br><span class="line">#</span><br><span class="line">;    security = user</span><br><span class="line">;    passdb backend = tdbsam</span><br><span class="line"></span><br><span class="line">让samba成为域的主浏览器</span><br><span class="line">;    domain master = yes</span><br><span class="line">允许samba为windows提供网络登录服务</span><br><span class="line">;    domain logons = yes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # the following login script name is determined by the machine name</span><br><span class="line">    # (%m):</span><br><span class="line">定义客户端在登录时要执行的脚本</span><br><span class="line">;    logon script = %m.bat</span><br><span class="line">    # the following login script name is determined by the UNIX user used:</span><br><span class="line">;    logon script = %u.bat</span><br><span class="line">定义记录用户个性化信息的文件存放的位置，空值表示禁用个性化设置</span><br><span class="line">;    logon path = \\%L\Profiles\%u</span><br><span class="line">    # use an empty path to disable profile support:</span><br><span class="line">;    logon path =</span><br><span class="line"></span><br><span class="line">    # various scripts can be used on a domain controller or a stand-alone</span><br><span class="line">    # machine to add or delete corresponding UNIX accounts:</span><br><span class="line">定义做为域控时，针对于用户和主机的添加、删除时需要执行的具体操作</span><br><span class="line">;    add user script = /usr/sbin/useradd &quot;%u&quot; -n -g users</span><br><span class="line">;    add group script = /usr/sbin/groupadd &quot;%g&quot;</span><br><span class="line">;    add machine script = /usr/sbin/useradd -n -c &quot;Workstation (%u)&quot; -M -d /nohome -s /bin/false &quot;%u&quot;</span><br><span class="line">;    delete user script = /usr/sbin/userdel &quot;%u&quot;</span><br><span class="line">;    delete user from group script = /usr/sbin/userdel &quot;%u&quot; &quot;%g&quot;</span><br><span class="line">;    delete group script = /usr/sbin/groupdel &quot;%g&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">这些设置选项主要用于SMB网络中进行浏览时，设置samba服务器的行为。缺省情况不让 samba服务器参加broswser的推举过程，为了使得samba服务器能成为browser，就需要设定local master =yes。然后samba服务就可以根据os level设置的权重进行推举，缺省的os level为0，这个权重不会赢得推举。但可以取消注释，将os level设置为33，这将在与所有Windows计算机（包括Windows NT）的推举竞赛中获得胜利，因为NT server的权重为32。设置比33更高的权重，只是在不同的samba 服务器之间进行选择时才有意义。</span><br><span class="line">#</span><br><span class="line">preferred master  可以设置自己优先成为浏览服务器候选人</span><br><span class="line">#</span><br><span class="line"># ----------------------- Browser Control Options ----------------------------</span><br><span class="line">#</span><br><span class="line"># local master = when set to no, Samba does not become the master browser on</span><br><span class="line"># your network. When set to yes, normal election rules apply.</span><br><span class="line">#</span><br><span class="line"># os level = determines the precedence the server has in master browser</span><br><span class="line"># elections. The default value should be reasonable.</span><br><span class="line">#</span><br><span class="line"># preferred master = when set to yes, Samba forces a local browser election at</span><br><span class="line"># start up (and gives itself a slightly higher chance of winning the election).</span><br><span class="line">#</span><br><span class="line">;    local master = no</span><br><span class="line">;    os level = 33</span><br><span class="line">;    preferred master = yes</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line">#</span><br><span class="line">wins服务，如果网络中配置了wins服务器可以在此设置wins相关项</span><br><span class="line">#----------------------------- Name Resolution -------------------------------</span><br><span class="line">#</span><br><span class="line"># This section details the support for the Windows Internet Name Service (WINS).</span><br><span class="line">#</span><br><span class="line"># Note: Samba can be either a WINS server or a WINS client, but not both.</span><br><span class="line">#</span><br><span class="line"># wins support = when set to yes, the NMBD component of Samba enables its WINS</span><br><span class="line"># server.</span><br><span class="line">#</span><br><span class="line"># wins server = tells the NMBD component of Samba to be a WINS client.</span><br><span class="line">#</span><br><span class="line"># wins proxy = when set to yes, Samba answers name resolution queries on behalf</span><br><span class="line"># of a non WINS capable client. For this to work, there must be at least one</span><br><span class="line"># WINS server on the network. The default is no.</span><br><span class="line">#</span><br><span class="line"># dns proxy = when set to yes, Samba attempts to resolve NetBIOS names via DNS</span><br><span class="line"># nslookups.</span><br><span class="line">设置nmb进程支持wins服务</span><br><span class="line">;    wins support = yes</span><br><span class="line">设置wins服务器ip</span><br><span class="line">;    wins server = w.x.y.z</span><br><span class="line">设置wins代理IP</span><br><span class="line">;    wins proxy = yes</span><br><span class="line">设置Samba服务器是否在无法联系WINS服务器时通过DNS去解析主机的NetBIOS名</span><br><span class="line">;    dns proxy = yes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">该部分包括Samba服务器打印机相关设置</span><br><span class="line"># --------------------------- Printing Options -----------------------------</span><br><span class="line">#</span><br><span class="line"># The options in this section allow you to configure a non-default printing</span><br><span class="line"># system.</span><br><span class="line">#</span><br><span class="line"># load printers = when set you yes, the list of printers is automatically</span><br><span class="line"># loaded, rather than setting them up individually.</span><br><span class="line">#</span><br><span class="line"># cups options = allows you to pass options to the CUPS library. Setting this</span><br><span class="line"># option to raw, for example, allows you to use drivers on your Windows clients.</span><br><span class="line">#</span><br><span class="line"># printcap name = used to specify an alternative printcap file.</span><br><span class="line">#</span><br><span class="line">是否启用共享打印机</span><br><span class="line">    load printers = yes</span><br><span class="line">    cups options = raw</span><br><span class="line">打印机配置文件</span><br><span class="line">;    printcap name = /etc/printcap</span><br><span class="line">    # obtain a list of printers automatically on UNIX System V systems:</span><br><span class="line">;    printcap name = lpstat</span><br><span class="line">打印机的系统类型,现在支持的打印系统有：bsd, sysv, plp, lprng, aix, hpux, qnx,cups</span><br><span class="line">;    printing = cups</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">该部分包括Samba服务器如何保留从Windows客户端复制或移动到Samba服务器共享目录文件的Windows文件属性的相关配置.</span><br><span class="line"># --------------------------- File System Options ---------------------------</span><br><span class="line">#</span><br><span class="line"># The options in this section can be un-commented if the file system supports</span><br><span class="line"># extended attributes, and those attributes are enabled (usually via the</span><br><span class="line"># &quot;user_xattr&quot; mount option). These options allow the administrator to specify</span><br><span class="line"># that DOS attributes are stored in extended attributes and also make sure that</span><br><span class="line"># Samba does not change the permission bits.</span><br><span class="line">#</span><br><span class="line"># Note: These options can be used on a per-share basis. Setting them globally</span><br><span class="line"># (in the [global] section) makes them the default for all shares.</span><br><span class="line"></span><br><span class="line">当Windows客户端将文件复制或移动到Samba服务器共享目录时，是否保留文件在Windows中的存档属性。默认no。</span><br><span class="line">;    map archive = no</span><br><span class="line">当Windows客户端将文件复制或移动到Samba服务器共享目录时，是否保留文件在Windows中的隐藏属性。默认no。</span><br><span class="line">;    map hidden = no</span><br><span class="line">当Windows客户端将文件复制或移动到Samba服务器共享目录时，是否保留文件在Windows中的只读属性。默认为no。</span><br><span class="line">;    map read only = no</span><br><span class="line">当Windows客户端将文件复制或移动到Samba服务器共享目录时，是否保留文件在Windows中的系统文件属性。默认为no。</span><br><span class="line">;    map system = no</span><br><span class="line">当Windows客户端将文件复制或移动到Samba服务器共享目录时，是否保留文件在Windows中的相关属性（只读、系统、隐藏、存档属性）。默认为yes。</span><br><span class="line">;    store dos attributes = yes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">共享设置</span><br><span class="line">#============================ Share Definitions ==============================</span><br><span class="line">#用户家目录共享</span><br><span class="line">#共享名称</span><br><span class="line">[homes]</span><br><span class="line">描述</span><br><span class="line">    comment = Home Directories</span><br><span class="line">是否为隐藏共享</span><br><span class="line">    browseable = no</span><br><span class="line">是否允许写入</span><br><span class="line">    writable = yes</span><br><span class="line">允许访问该共享资源的smb用户，@组</span><br><span class="line">;    valid users = %S</span><br><span class="line">;    valid users = MYDOMAIN\%S</span><br><span class="line"></span><br><span class="line">打印机共享</span><br><span class="line">[printers]</span><br><span class="line">描述</span><br><span class="line">    comment = All Printers</span><br><span class="line">路径</span><br><span class="line">    path = /var/spool/samba</span><br><span class="line">是否可浏览，no类似隐藏共享</span><br><span class="line">    browseable = no</span><br><span class="line">是否支持guest访问，和public指令类似    </span><br><span class="line">    guest ok = no</span><br><span class="line">是否可写</span><br><span class="line">    writable = no</span><br><span class="line">是否允许打印</span><br><span class="line">    printable = yes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Un-comment the following and create the netlogon directory for Domain Logons:</span><br><span class="line">;    [netlogon]</span><br><span class="line">;    comment = Network Logon Service</span><br><span class="line">;    path = /var/lib/samba/netlogon</span><br><span class="line">;    guest ok = yes</span><br><span class="line">;    writable = no</span><br><span class="line">;    share modes = no</span><br><span class="line"></span><br><span class="line"># Un-comment the following to provide a specific roaming profile share.</span><br><span class="line"># The default is to use the user&#x27;s home directory:</span><br><span class="line">;    [Profiles]</span><br><span class="line">;    path = /var/lib/samba/profiles</span><br><span class="line">;    browseable = no</span><br><span class="line">;    guest ok = yes</span><br><span class="line"></span><br><span class="line"># A publicly accessible directory that is read only, except for users in the</span><br><span class="line"># &quot;staff&quot; group (which have write permissions):</span><br><span class="line">;    [public]</span><br><span class="line">;    comment = Public Stuff</span><br><span class="line">;    path = /home/samba</span><br><span class="line">;    public = yes</span><br><span class="line">;    writable = no</span><br><span class="line">;    printable = no</span><br><span class="line">定义允许哪些smb用户写入，+和@表示一个组</span><br><span class="line">;    write list = +staff</span><br></pre></td></tr></table></figure>

<h2 id="四、samba文件共享案例"><a href="#四、samba文件共享案例" class="headerlink" title="四、samba文件共享案例"></a>四、samba文件共享案例</h2><p>拓扑图</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932305163.png)" alt="环境：两台安装CentOS8的主机，关闭selinux，关闭防火墙 **案例需求:** 1)、新建文件夹/common 2)、在server上配置SMB服务 3)、您的 SMB 服务器必须是 workgroup 工作组的一个成员 4)、共享 /common 目录 共享名必须为 common 5 image20200306155842923.png"/></div><div class="image-meta"><span class="image-caption center">环境：两台安装CentOS8的主机，关闭selinux，关闭防火墙 **案例需求:** 1)、新建文件夹/common 2)、在server上配置SMB服务 3)、您的 SMB 服务器必须是 workgroup 工作组的一个成员 4)、共享 /common 目录 共享名必须为 common 5 image20200306155842923.png</span></div></div>、只有 192.168.11.0网段内的客户端可以访问 common 共享

<p>6）、common 必须是可以浏览的</p>
<p>7）、用户hello 必须能够读取共享中的内容，如果需要的话，验证的密码是 hello</p>
<p>8）、用户 test 必须能够拥有写权限，如果需要的话，验证的密码是 test</p>
<p>a、创建共享目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# mkdir /common</span><br></pre></td></tr></table></figure>

<p>b、设置共享目录权限，因为默认权限是755除了管理员外，其他人只能读不能写，本实验中要求test能写，所以其他人加写权限。在samba中共享目录的权限除了看samba服务的设置之外，还要看系统的权限设置，系统针对于权限不一致的处理方式是取交集。所以各位在建立共享时一定要注意权限方面的问题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# chmod 757 /common</span><br><span class="line">[root@node1 ~]# cd /etc/samba/</span><br><span class="line">[root@node1 ~]# vim /etc/samba/smb.conf</span><br><span class="line"># read the smb.conf manpage.</span><br><span class="line"># Run &#x27;testparm&#x27; to verify the config is correct after</span><br><span class="line"># you modified it.</span><br><span class="line"></span><br><span class="line">[global]</span><br><span class="line">    #设置工作组为workgroup</span><br><span class="line">    workgroup = workgroup</span><br><span class="line">    security = user</span><br><span class="line"></span><br><span class="line">    passdb backend = tdbsam</span><br><span class="line"></span><br><span class="line">    printing = cups</span><br><span class="line">    printcap name = cups</span><br><span class="line">    load printers = yes</span><br><span class="line">    cups options = raw</span><br><span class="line"></span><br><span class="line">[homes]</span><br><span class="line">    comment = Home Directories</span><br><span class="line">    valid users = %S, %D%w%S</span><br><span class="line">    browseable = no</span><br><span class="line">    read only = no</span><br><span class="line">    inherit acls = yes</span><br><span class="line"></span><br><span class="line">[printers]</span><br><span class="line">    comment = All Printers</span><br><span class="line">    path = /var/tmp</span><br><span class="line">    printable = yes</span><br><span class="line">    create mask = 0600</span><br><span class="line">    browseable = no</span><br><span class="line"></span><br><span class="line">#共享设置，参考配置文件详解理解以下选项</span><br><span class="line">[common]</span><br><span class="line">    comment = samba file share test</span><br><span class="line">    path = /common	#绝对路径</span><br><span class="line">    browseable = yes</span><br><span class="line">    hosts allow  = 192.168.11.0/255.255.255.0</span><br><span class="line">    valid users = hello,test</span><br><span class="line">    writable = no</span><br><span class="line">    write list = test</span><br><span class="line">    public = no </span><br></pre></td></tr></table></figure>

<p>c、重启服务生效</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~] systemctl restart smb nmb</span><br></pre></td></tr></table></figure>

<p>d、创建samba用户<br>使用useradd命令创建hello和test用户并设置密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# smbpasswd -a hello</span><br><span class="line">New SMB password:</span><br><span class="line">Retype new SMB password:</span><br><span class="line">[root@node1 ~]# smbpasswd -a test</span><br><span class="line">New SMB password:</span><br><span class="line">Retype new SMB password:</span><br></pre></td></tr></table></figure>

<p><strong>共享指令拓展</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">valid users 指定能够进入此资源的特定用户和组</span><br><span class="line">invalid users 指定不能够使用该共享资源的用户和组</span><br><span class="line">read list 指定只能读取该共享资源的用户和组。 </span><br><span class="line">write list 指定能读取和写该共享资源的用户和组。 </span><br><span class="line">admin list 指定能管理该共享资源（包括读写和权限赋予等）的用户和组。 </span><br><span class="line">public 指明该共享资源是否能给游客帐号访问，这个开关有时候也叫guest ok，所以有的配置文件中出现guest ok = yes其实和public = yes是一样的。 </span><br><span class="line">hide dot files 指明是不是像unix那样隐藏以“.”号开头的文件。 </span><br><span class="line">create mask 指明新建立的文件的属性，一般是0755。 </span><br><span class="line">directory mode 指明新建立的目录的属性，一般是0755。 </span><br><span class="line">sync always 指明对该共享资源进行写操作后是否进行同步操作。 </span><br><span class="line">preserve case 指明保持大小写。yes/no </span><br><span class="line">case sensitive 指明是否对大小写敏感，一般选no,不然可能引起错误。 </span><br><span class="line">default case 指明缺省的文件名是全部大写还是小写。upper/lower </span><br><span class="line">force user 强制把建立文件的属主是谁。如果我有一个目录，让来宾用户可以写，那么来宾用户就可以删除，如果我用 force user=王老师 强制建立文件的属主是 王老师 ，同时限制create mask=0755，这样来宾用户就不能删除了</span><br><span class="line">wide links 指明是否允许共享外符号连接，比如共享资源里面有个连接指向非共享资源里面的文件或者目录，如果设置wide links = no将使该连接不可用。 </span><br><span class="line">max connections = n 设定同时连接数是n。 </span><br><span class="line">delete readonly 指明能否删除共享资源里面已经被定义为只读的文件</span><br></pre></td></tr></table></figure>

<h2 id="五、共享案例-客户端访问共享"><a href="#五、共享案例-客户端访问共享" class="headerlink" title="五、共享案例-客户端访问共享"></a>五、共享案例-客户端访问共享</h2><p>创建好了共享了，如果用户希望访问samba共享，windows用户通过网上邻居或者在运行中输出[\IP\共享名]的方式访问samba共享，也可以通过网络映射的方式将共享挂载的本地。linux或者UNIX用户则可以使用samba提供的客户端smbclient或者通过CIFS协议将共享挂载到本地。</p>
<p><strong>smbclient 客户端命令</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">smbclient - 类似FTP操作方式的访问SMB/CIFS服务器资源的客户端</span><br><span class="line">常用命令选项</span><br><span class="line">-L     此选项允许你查看服务器上可以获得的服务资源</span><br><span class="line">-U|--user=username[%password]  这个参数指定程序联接时使用的用户名或者用户名和密码，如果没指定%password，将提示用户输入。</span><br><span class="line">-W|--workgroup=domain   设置用户名的SMB域。这个选项越过了smb.conf配置文件中的默认域。</span><br><span class="line">-N     如果指定了这个选项，就会省略通常的口令提示。当访问无需口令的服务资源时它很有用。</span><br></pre></td></tr></table></figure>

<p><strong>任务需求</strong><br>linux下访问samba共享</p>
<p>a、客户端信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@slave ~]# ifconfig ens33</span><br><span class="line">ens33: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.11.116  netmask 255.255.255.0  broadcast 192.168.11.255</span><br><span class="line">        inet6 fe80::20c:29ff:fe8e:ea58  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:8e:ea:58  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 5166  bytes 3736352 (3.5 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 2311  bytes 297960 (290.9 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>

<p>b、使用smbclient访问共享，验证第四点教学案例设置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">测试用户 hello</span><br><span class="line">[root@manage01 ~]# smbclient  //192.168.11.16/common -U hello</span><br><span class="line">Enter SAMBA\hello&#x27;s password: </span><br><span class="line">或</span><br><span class="line">[root@manage01 ~]# smbclient  //192.168.11.16/common -U hello%hello</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">smb: \&gt; lcd /etc/</span><br><span class="line">smb: \&gt; put passwd              写入失败</span><br><span class="line">NT_STATUS_ACCESS_DENIED opening remote file \passwd </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">测试用户test</span><br><span class="line">[root@manage01 ~]# smbclient //192.168.11.16/common -U test%test </span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; lcd /etc/</span><br><span class="line">smb: \&gt; put passwd</span><br><span class="line">putting file passwd as \passwd (728.2 kb/s) (average 728.2 kb/s)     可以上传</span><br><span class="line">smb: \&gt; exit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">samba命令类似于ftp文本界面命令，参考之前的vsftp使用。</span><br></pre></td></tr></table></figure>

<p>c、linux挂载共享</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@manage01 ~]# mkdir /opt/samba_share</span><br><span class="line">[root@manage01 ~]# mount -o username=hello,password=hello -t cifs //192.168.11.16/common /opt/samba_share</span><br><span class="line">[root@manage01 ~]# cd /opt/samba_share/</span><br><span class="line">[root@manage01 ~]# mount</span><br><span class="line">......</span><br><span class="line">//192.168.11.16/common on /opt/samba_share type cifs (rw,relatime,vers=default,cache=strict,username=hello,domain=,uid=0,noforceuid,gid=0,noforcegid,addr=192.168.11.16,file_mode=0755,dir_mode=0755,soft,nounix,serverino,mapposix,rsize=1048576,wsize=1048576,echo_interval=60,actimeo=1)</span><br><span class="line"></span><br><span class="line">[root@manage01 ~]# ls /mnt/samba_share/</span><br><span class="line">initial-setup-ks.cfg  passwd</span><br></pre></td></tr></table></figure>

<p>d、windows访问共享</p>
<p>打开开始菜单如下输入</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932645309.png" alt="image20200306180124957.png"/></div><div class="image-meta"><span class="image-caption center">image20200306180124957.png</span></div></div>

<p>回车以后出现下图，输入账号密码</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932658185.png" alt="image20200306180151262.png"/></div><div class="image-meta"><span class="image-caption center">image20200306180151262.png</span></div></div>

<p>点击确定按钮</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932672237.png" alt="image20200306180244476.png"/></div><div class="image-meta"><span class="image-caption center">image20200306180244476.png</span></div></div>

<h2 id="六、用户账号映射与访问控制"><a href="#六、用户账号映射与访问控制" class="headerlink" title="六、用户账号映射与访问控制"></a>六、用户账号映射与访问控制</h2><p><strong>账号映射</strong></p>
<p>samba的用户帐号信息是保存在smbpasswd文件中，而 且可以访问samba服务器的帐号也必须对应一个同名的系 统帐号。基于这一点，所以，对于一些hacker来说，只要 知道samba服务器samba帐号，就等于是知道了Linux系 统帐号，只要crack其samba帐号密码加以利用就可以攻 击samba服务器。所以我们要使用用户帐号映射这个功能 来解决这个问题</p>
<ul>
<li>用户帐号映射这个功能需要建立一个帐号映射关系表，里 面记录了samba帐号和虚拟帐号的对应关系，客户端访问 samba服务器时就使用虚拟来登录。</li>
<li>编辑主配置文件&#x2F;etc&#x2F;samba&#x2F;smb.conf在global下添加一行字段username map &#x3D; &#x2F;etc&#x2F;samba&#x2F;smbusers 开启用户帐号映射功能。</li>
</ul>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932687479.png" alt="image20200306183028366.png"/></div><div class="image-meta"><span class="image-caption center">image20200306183028366.png</span></div></div>

<p>编辑&#x2F;etc&#x2F;samba&#x2F;smbusers</p>
<p>smbusers文件保存帐号映射关系，其有固 定格式:</p>
<p>samba帐号 &#x3D; 虚拟帐号(映射帐号)</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://www.zutuanxue.com:8000/static/media/images/2020/10/29/1603932698858.png" alt="image20200306183052382.png"/></div><div class="image-meta"><span class="image-caption center">image20200306183052382.png</span></div></div>

<p>重新启动服务</p>
<p><strong>访问控制</strong></p>
<p>对于samba服务器的安全性，我们已经说过可以使用valid users字段去实现用户访问控制，但是如果企业庞大，存在大量用户的话，这种方法操作起来就显得比较麻烦比如samba服务器共享出一个目录来访问，但是要禁止某个IP子网或某个域的客户端访问此资源，这样情况使用valid users字段就无法实现客户端访问控制。使用hosts allow和hosts deny两个字段来实现该功能。而用好这两个字段关键在于熟悉和清楚它们的使用方法和作用范围</p>
<p>1）hosts allow 和 hosts deny 字段的使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hosts allow 字段定义允许访问的客户端 </span><br><span class="line"></span><br><span class="line">hosts deny 字段定义禁止访问的客户端 </span><br></pre></td></tr></table></figure>

<p>2）使用IP地址进行限制</p>
<p>比如公司内部samba服务器上共享了一个目录sales，这个目录是存放销售部的共享目录，公司规定192.168.0.0&#x2F;24这个网段的IP地址禁止访问此sales共享目录，但是其中192.168.0.24这个IP地址可以访问。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hosts deny = 192.168.0. 172.16.</span><br><span class="line">hosts allow = 192.168.0.24</span><br><span class="line">hosts deny = 192.168.0. 表示禁止所有来自192.168.0.0/24网段的IP地址访问 </span><br><span class="line">hosts allow = 192.168.0.24 表示允许192.168.0.24这个IP地址访问 </span><br><span class="line">当host deny和hosts allow字段同时出现并定义内容相互冲突时，hosts allow优先。现在设置的意思就是禁止C类地址192.168.0.0/24网段主机访问，但是允许192.168.0.24主机访问。如果后面的内容有多个时，需要用空格隔开，也可以是域名，如：.hello.com</span><br></pre></td></tr></table></figure>

<p>如果我们规定所有人不能访问security目录，只允许192.168.0.0网段的IP地址可以访问，但是192.168.0.10及192.168.0.78的主机是要禁止访问。我们可以使用hosts deny禁止所有用户访问，再设置hosts allow允许192.168.0.0网段主机，但当hosts deny和hosts allow同时出现而且冲突的时候，hosts allow生效，如果这样，那么允许192.168.0.0网段的IP地址可以访问，但192.168.0.100及192.168.0.78的主机禁止访问就无法生效了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hosts allow = 192.168.0. EXCEPT 192.168.0.100 192.168.0.78 </span><br><span class="line"></span><br><span class="line">表示允许192.168.0.0网段IP地址访问，但是192.168.0.100和192.168.0.78除外</span><br></pre></td></tr></table></figure>

<h2 id="七、SAMBA的排错"><a href="#七、SAMBA的排错" class="headerlink" title="七、SAMBA的排错"></a>七、SAMBA的排错</h2><p><strong>Linux 服务一般排错方法</strong><br>1、错误信息</p>
<p>一般仔细看下显示的错误信息，根据错误提示一般就可以判断问题出在 什么地方。</p>
<p>2、配置文件</p>
<p>第2个我们可以查配置文件，有时可能误操作导致配置失误，服务无法正 常运行，我们可以通过检查配置文件来确认问题。现在很多服务的软件 包有自带配置文件检查工具，我们可以通过这些工具对配置文件进行检 查</p>
<p>3、日志文件<br>如果服务出现问题，我们还可以使用 tail -f命令来动态监控日志文件</p>
<p><strong>Samba排错</strong></p>
<p>1、使用testparm命令检查，软件包有自带的配置文件检查工具，我们可以使testparm 命令检测smb.conf文件的语法，如果报错，说明smb.conf文 件设置有错误，这样我们可以根据提示信息来修改主配置文 件和独立配置文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# testparm /etc/samba/smb.conf</span><br><span class="line">Load smb config files from /etc/samba/smb.conf</span><br><span class="line">rlimit_max: increasing rlimit_max (1024) to minimum Windows limit (16384)</span><br><span class="line">Processing section &quot;[homes]&quot;</span><br><span class="line">Processing section &quot;[printers]&quot;</span><br><span class="line">Processing section &quot;[common]&quot;</span><br><span class="line">Loaded services file OK.</span><br><span class="line">Server role: ROLE_STANDALONE</span><br></pre></td></tr></table></figure>

<p>2、使用ping命令测试</p>
<p>samba服务器主配置文件排除错误后重启 smb服务，如果客户端仍然 无法连 接samba服务器，我们在客户端可以使用 ping命令进行测试,这个我们微软的系统中排障一样，根据出现的不同情况可以进行分析。</p>
<p>(1)如果没有收到任何提示，说明客户端 TCP&#x2F;IP协议安装有问题，需要重 新安装客户端 TCP&#x2F;IP 协议，然后重新测试。</p>
<p>(2)如果提示“host not found ”则检查客户端DNS或者&#x2F;etc&#x2F;hosts文件有没正确设置，确保客户端能够使用名称访问 samba服务器。</p>
<p>(3)无法 ping 通还可能是防火墙设置问题，需要重新设置防火墙的 规则，开启samba 与外界联系的端口。<br>(4)当然还有一种低级的情况，那就是由于主机名输入错误导致不 能ping 通</p>
<p>3、使用smbclient命令进行测试</p>
<p>如果客户端与samba服务器可以ping通，说明客户端与服务器间的连接没有问题，如果还是不能访问samba共享资源，可以执行smbclient命令进一步测试服务器端的配置。 如果测试samba服务器正常，并且输入了正确的帐号和密码，那么执行smbclient命令就可以获得共享列表。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L 192.168.0.188 -U joy%123 </span><br></pre></td></tr></table></figure>

<p>如果我们看到了错误信息提示“tree connect failed”则说明可以在smb.conf文件中设置了host deny字段拒绝了客户端的IP地址或域 名，我们可以修改smb.conf配置文件允许客户端访问就可以了</p>
<p>如果返回信息是“connection refused ”提示拒绝连接则说明是samba服务器smbd进程可以没有被开启，我们必须确保smbd和 nmbd进程处于开启状态，并使用netstat命令检查netbios所使用的139端口是否处于监听状态。</p>
<p>如果提示“session setup failed ”连接建立失败则说明服务器拒绝了连接请求，这是因为输入的用户名和密码错误引起</p>
<p>有时也会收到比如“Your server software is being unfriendly ”错误信息，提示服务器软 件存在问题，这个故障一般是因为配置 smbd时使用了错误的参数或者启用 smbd时 遇到的类似严重破坏错误，我们可以使用 testparm来检查相应的配置文件并同时检查 相关日志文件。</p>



<div class="article-footer reveal fs14"><section id="license"><div class="header"><span>许可协议</span></div><div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div></section></div>

</article>

<div class="related-wrap reveal" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">较新文章</div><a href="/2023/09/27/Linux%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%AE%9D%E5%85%B8/Linux-%E9%9A%90%E8%97%8F%E6%9D%83%E9%99%90/">linux隐藏权限</a></div><div class="item" id="next"><div class="note">较早文章</div><a href="/2023/09/27/%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%B9%8B%E4%BC%81%E4%B8%9A%E5%AD%98%E5%82%A8/NFS%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/">NFS文件服务器</a></div></section></div>








      
<footer class="page-footer reveal fs12"><hr><div class="text"><p>本站由 <a href="/">@anonymity</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar">Stellar</a> 主题创建。<br>本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p>
</div></footer>

      <div class='float-panel mobile-only blur' style='display:none'>
  <button type='button' class='sidebar-toggle mobile' onclick='sidebar.toggle()'>
    <svg class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15301"><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 2.3 26.8 24.6 47.5 51.6 47.6h416.5v4z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15302"></path><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 1.9 27.7 23.9 49.7 51.6 51.6h416.5z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15303"></path></svg>
  </button>
</div>

    </div>
  </div>
  <div class='scripts'>
    <script type="text/javascript">
  const stellar = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    loadCSS: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    // 从 butterfly 和 volantis 获得灵感
    loadScript: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = stellar.config.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    // https://github.com/jerryc127/hexo-theme-butterfly
    jQuery: (fn) => {
      if (typeof jQuery === 'undefined') {
        stellar.loadScript(stellar.plugins.jQuery).then(fn)
      } else {
        fn()
      }
    }
  };
  stellar.version = '1.19.0';
  stellar.github = 'https://github.com/xaoxuu/hexo-theme-stellar/tree/1.19.0';
  stellar.config = {
    date_suffix: {
      just: '刚刚',
      min: '分钟前',
      hour: '小时前',
      day: '天前',
      month: '个月前',
    },
    root : '/',
  };

  // required plugins (only load if needs)
  stellar.plugins = {
    jQuery: 'https://gcore.jsdelivr.net/npm/jquery@3.6.2/dist/jquery.min.js'
  };

  if ('local_search') {
    stellar.search = {};
    stellar.search.service = 'local_search';
    if (stellar.search.service == 'local_search') {
      let service_obj = Object.assign({}, {"field":"all","path":"/search.json","content":true,"sort":"-date"});
      stellar.search[stellar.search.service] = service_obj;
    }
  }

  // stellar js
  stellar.plugins.stellar = Object.assign({"sites":"/js/plugins/sites.js","friends":"/js/plugins/friends.js","ghinfo":"/js/plugins/ghinfo.js","timeline":"/js/plugins/timeline.js","linkcard":"/js/plugins/linkcard.js","fcircle":"/js/plugins/fcircle.js","weibo":"/js/plugins/weibo.js"});

  stellar.plugins.marked = Object.assign("https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js");
  // optional plugins
  if ('true' == 'true') {
    stellar.plugins.lazyload = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/vanilla-lazyload@17.8.3/dist/lazyload.min.js","transition":"blur"});
  }
  if ('true' == 'true') {
    stellar.plugins.swiper = Object.assign({"enable":true,"css":"https://unpkg.com/swiper@8.4.5/swiper-bundle.min.css","js":"https://unpkg.com/swiper@8.4.5/swiper-bundle.min.js"});
  }
  if ('' == 'true') {
    stellar.plugins.scrollreveal = Object.assign({"enable":null,"js":"https://gcore.jsdelivr.net/npm/scrollreveal@4.0.9/dist/scrollreveal.min.js","distance":"8px","duration":500,"interval":100,"scale":1});
  }
  if ('true' == 'true') {
    stellar.plugins.preload = Object.assign({"enable":true,"service":"flying_pages","instant_page":"https://gcore.jsdelivr.net/gh/volantis-x/cdn-volantis@4.1.2/js/instant_page.js","flying_pages":"https://gcore.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.fancybox = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js","css":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css","selector":".swiper-slide img"});
  }
  if ('false' == 'true') {
    stellar.plugins.heti = Object.assign({"enable":false,"css":"https://unpkg.com/heti@0.9.2/umd/heti.min.css","js":"https://unpkg.com/heti@0.9.2/umd/heti-addon.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.copycode = Object.assign({"enable":true,"js":"/js/plugins/copycode.js","default_text":"Copy","success_text":"Copied"});
  }
</script>

<!-- required -->

  
<script src="/js/main.js" async></script>



<!-- optional -->



<!-- inject -->


  </div>
</body>
</html>
